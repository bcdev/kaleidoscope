#!/usr/bin/env bash
#
# Copyright (c) Brockmann Consult GmbH, 2025
# License: MIT
#
set -e
## Produces Monte Carlo variants of the ESA SCOPE Exchange product.
#
#  ./kaleidoscope-esa-scope-ex <file>
#
for selector in 000 001 002 003 004 005 006 007 008 009 010; do
  echo "$(tput setaf 2)$(date -u "+%Y-%m-%dT%H:%M:%S") [INFO] Selector ${selector} ...$(tput sgr0)"
  source_file="${1}"
  target_file="${1%.nc}"."${selector}".nc
  if [ -f "${target_file}" ]; then
    continue
  fi
  kaleidoscope \
    --selector ${selector} \
    --source-type esa-scope-exchange \
    --log-level warning \
    --progress \
    "${source_file}" \
    "${target_file}"
done
